--CREANDO LA BASE DE DATOS MILENIUM
CREATE DATABASE MILENIUM

USE MILENIUM

--CREAMOS LA TABLA DE CLIENTES
CREATE TABLE CLIENTES
(
Id int Primary Key not null,
Nombre varchar(50),
Apellido varchar(50),
Edad int
)

SELECT * FROM CLIENTES

--CREAMOS LA TABLA DE VENTAS
CREATE TABLE VENTAS
(
Id int Primary Key Not Null,
IdProducto int,
IdCliente int,
Fecha date
)

SELECT * FROM VENTAS

--CREAMOS LA TABLA DE PRODUCTOS
CREATE TABLE PRODUCTOS
(
CodProducto int Primary Key Not Null,
Nombre varchar(50),
Fecha date,
Precio money
)

SELECT * FROM PRODUCTOS
--############################################################
--ALTERAMOS LOS PERMISOS
ALTER AUTHORIZATION ON DATABASE::MILENIUM TO SA


--#########     RELACIONAMOS TABLAS #############
--RELACIONANDO TABLA VENTAS _ CLIENTES
ALTER TABLE VENTAS
ADD CONSTRAINT FK_VENTAS_CLIENTES
FOREIGN KEY (IdCliente) REFERENCES CLIENTES(Id)

--#########################################################

--RELACIONANDO TABLA VENTAS _ CLIENTES

ALTER TABLE VENTAS
ADD CONSTRAINT FK_VENTAS_PRODUCTOS
FOREIGN KEY (IdProducto) REFERENCES PRODUCTOS(CodProducto)

--CARGAMOS REGISTRO A LAS TABLAS

--TABLA DE REGISTRO "CLIENTE"
INSERT INTO CLIENTES
VALUES
( '1','JOSE LUIS','VASQUEZ DELGADO',22),
( '2','CAMILA','PAREDES LOZANO',25),
( '3','ANDRES','PINEDO QUISPE',27),
( '4','MIREYA','LOJA CARDENAS',26),
( '5','PATRICIO','FLORES SANTOS',28),
( '6','MARIA LUZ','BARBOZA PERES',22),
( '7','ANTONIO','SANTOS TRAUCO',25),
( '8','NATHALY','SUISA SUARES',22),
( '9','PEDRO ALEJANDRO','RIMARACHIN CORDONES',23),
( '10','ANGELICA BIANCA','MAQUIAS POLORE',25)

SELECT * FROM CLIENTES

DELETE FROM CLIENTES

--TABLA DE REGISTRO "PRODUCTOS"
INSERT INTO PRODUCTOS
VALUES 
('101','SMART TV- SAMSUNG','11/01/2019',3000.00),
('102','CELULAR - HUAWEI P20','11/02/2019',1000.00),
('103','SPEAKERS - SUNNY','11/03/2019',500.00),
('104','MOUSE - CYBERTEL','11/04/2019',40.00),
('105','KEYBOARD - MICRONICS','11/05/2019',120.00),
('106','TABLET - IPAD PRO','11/06/2019',3100.00),
('107','SMART TV - LG','11/17/2019',2800.00),
('108','TABLET - SAMSUNG PRO','11/08/2019',3200.00),
('109','CELULAR - XIAMOI','11/09/2019',2500.00),
('110','CELULAR - IPHONE 11PRO','11/10/2019',4000.00),
('111','COMPUTADOR - MAC','11/11/2019',5000.00),
('112','PENCEL KEY TABLE','11/12/2019',110.00),
('113','SMART TV - ANOC','11/13/2019',1450.00),
('114','HEADPHONES - SAMSUNG','11-14-2019',440.00),
('115','HEADPHONES - KAFINY','11-15-2019',400.00),
('116','HEADPHONES - SIRI GOOGLE ','11-16-2019',350.00),
('117','KEYBOARD - SAMSUNG','11-17-2019',90.00),
('118','KEYBOARD - HUAWEI','11-18-2019',80.00),
('119','KEYBOARD - LG','11-19-2019',85.00),
('120','SPEAKERS - APLLE','11-20-2019',300.00)

SELECT * FROM PRODUCTOS

DELETE FROM PRODUCTOS

--TABLA DE REGISTRO "VENTAS"
INSERT INTO VENTAS
VALUES 
('1001','101','1','11/10/2019'),
('1002','102','2','11/11/2019'),
('1003','103','3','11/12/2019'),
('1004','104','4','11/13/2019'),
('1005','105','5','11/14/2019'),
('1006','106','6','11/15/2019'),
('1007','107','7','11/16/2019'),
('1008','108','8','11/17/2019'),
('1009','109','9','11/18/2019'),
('1010','110','10','11/19/2019'),
('1011','111','1','11/10/2019'),
('1012','112','2','11/11/2019'),
('1013','113','3','11/12/2019'),
('1014','114','4','11/13/2019'),
('1015','115','5','11/14/2019'),
('1016','116','6','11/15/2019'),
('1017','117','7','11/16/2019'),
('1018','118','8','11/17/2019'),
('1019','119','9','11/18/2019'),
('1020','120','10','11/19/2019')

SELECT * FROM VENTAS

DELETE FROM VENTAS

--RELACION DE RIGISTRO DE LA TABLA CLIENTES
SELECT * FROM CLIENTES

--RELACION DE RIGISTRO DE LA TABLA FACTURAS
SELECT * FROM VENTAS

--RELACION DE RIGISTRO DE LA TABLA DETALLES
SELECT * FROM PRODUCTOS

--#####  #####
--#      #   #
--#      #   #
--#####  #####

---------------CONSULTAS
----********************

-----1. Listado de Clientes
SELECT Nombre
from CLIENTES
ORDER BY Nombre ASC;

-----2. Listado de Productos
SELECT Nombre
from PRODUCTOS
ORDER BY Nombre ASC;

-----3. Listado de Ventas
SELECT Id
from VENTAS
ORDER BY Id ASC;

----4.Listado de Productos vendidos con sus precios y ordenados por fechas 
SELECT Nombre,Precio,Fecha
from PRODUCTOS
ORDER BY Fecha ASC;

----5.Listado de Clientes con sus productos comprados y sus respectivos precios
SELECT cli.Nombre,pro.Nombre,pro.Precio
FROM CLIENTES cli INNER JOIN VENTAS ven
ON cli.Id=ven.IdCliente
INNER JOIN PRODUCTOS pro
ON ven.IdProducto=pro.CodProducto

----6. Listado de Clientes, Productos, fecha y Monto de venta 
SELECT cli.Nombre,pro.Nombre,ven.Fecha,pro.Precio
FROM CLIENTES cli INNER JOIN VENTAS ven
ON cli.Id=ven.IdCliente
INNER JOIN PRODUCTOS pro
ON ven.IdProducto=pro.CodProducto
ORDER BY ven.Fecha ASC;
